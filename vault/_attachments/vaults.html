<!doctype html>
<html ng-app="vaults">
	<head>
		<title>Vault</title>
	</head>
	<body>
		<div ng-controller="VaultCtrl">
			<h3>Current vaults</h3>
			<table>
				<tr>
					<th rowspan="2">Name</th>
					<th rowspan="2">Connection Info</th>
					<th rowspan="2">Signature</th>
					<th rowspan="2">Priority</th>
					<th id="db-list-header" colspan="{{ dbs().length }}">Managed dbs</th>
				</tr>
				<tr id="db-list">
					<th ng-repeat="db in dbs()">{{ db }}</th>
				</tr>
				<tr ng-repeat="vault in vaults | orderBy:'-priority'">
					<td ng-click="editVault(vault)">{{ vault.name }}</td>
					<td ng-click="editVault(vault)">
						<span ng-hide="vault.addressable">Not addressable</span>
						<span ng-show="vault.addressable">{{ vault.addressable.host }}:{{ vault.addressable.port }}</span>
					</td>
					<td ng-click="editVault(vault)">{{ cappedStringify(vault.signature, 30) }}</td>
					<td ng-click="editVault(vault)">{{ vault.priority }}</td>
					<td ng-repeat="db in dbs()" ng-click="toggleDb(vault, db)">{{ vault.dbs.indexOf(db) != -1 }}</td>
				</tr>
			</table>
			<h3>Edit vaults</h3>
			<div>Name: <input type="text" ng-model="currentVault.name"/></div>
			<div>
				Connection info:
				<input type="text" ng-model="currentVault.addressable.host"/>
				<input type="number" ng-model="currentVault.addressable.port"/>
				<button ng-click="vaultNotReachable()">None</button>
			</div>
			<div>Signature: <textarea json ng-model="currentVault.signature"></textarea></div>
			<div>Priority: <input type="number" ng-model="currentVault.priority"/></div>
			<div>
				<button ng-click="newVault()">New</button>
				<button ng-click="saveVault()">Save</button>
				<button ng-click="deleteVault()">Delete</button>
			</div>
		</div>
	</body>

	<script src="angular/angular.min.js"></script>
	<script src="angular/angular-resource.min.js"></script>
	<script src="vaults.js"></script>

	<script type="text/javascript">
	</script>
</html>